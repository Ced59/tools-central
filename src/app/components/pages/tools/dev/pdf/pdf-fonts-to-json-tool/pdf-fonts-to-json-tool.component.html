<app-pdf-tool-shell
  [ui]="uiShell"
  icon="pi pi-file"
  [title]="ui.title"
  [subtitle]="ui.subtitle"
  [backLink]="backLink"
  [status]="status()"
  [fileName]="fileName()"
  [fileSize]="fileSize()"
  [tipMessage]="tipMessage()"
  [errorMessage]="shellErrorMessage()"
  [stats]="statsCards()"
  [totalCount]="fonts().length"
  [filteredCount]="filteredFonts().length"
  [filterControl]="form.controls.filter"
  [jsonText]="jsonText()"
  [showResults]="status() === 'ready'"
  (fileSelected)="onFileSelected($event)"
  (reset)="reset()"
  (copy)="copyJson()"
  (download)="downloadJson()"
>
  <!-- ✅ Left list -->
  <div leftList>
    @if (filteredFonts().length === 0) {
      <div class="empty-box">
        <i class="pi pi-search" aria-hidden="true"></i>
        <span i18n="@@pdf_fonts_empty">Aucune police à afficher.</span>
      </div>
    } @else {
      @for (it of filteredFonts(); track it.id) {
        <div class="field-card">
          <div class="field-card-header">
            <div class="field-card-title">
              <span class="field-name">{{ it.baseFont || '—' }}</span>
              @if (it.resourceKey) {
                <span class="muted mono">({{ it.resourceKey }})</span>
              }
            </div>

            @if (it.embedded !== null) {
              <div class="field-card-page">
                <span class="muted" i18n="@@pdf_fonts_embedded">Emb.</span>
                <span class="mono">{{ it.embedded ? 'true' : 'false' }}</span>
              </div>
            }
          </div>

          <!-- ✅ Advanced-like details (always, comme ton design actuel) -->
          <div class="field-card-advanced">
            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_family">Famille</div>
              <div class="adv-v mono">{{ it.family ?? 'null' }}</div>
            </div>

            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_subset">Subset</div>
              <div class="adv-v mono">{{ it.subset ?? 'null' }}</div>
            </div>

            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_style_guess">Style (guess)</div>
              <div class="adv-v mono">{{ it.styleGuess ? (it.styleGuess | json) : 'null' }}</div>
            </div>

            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_subtype">Subtype</div>
              <div class="adv-v mono">{{ it.subtype ?? 'null' }}</div>
            </div>

            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_encoding">Encodage</div>
              <div class="adv-v mono">{{ it.encoding ?? 'null' }}</div>
            </div>

            <div class="adv-kv">
              <div class="adv-k" i18n="@@pdf_fonts_tounicode">ToUnicode</div>
              <div class="adv-v mono">{{ it.toUnicode ?? 'null' }}</div>
            </div>

            @if (includePages()) {
              <div class="adv-kv">
                <div class="adv-k" i18n="@@pdf_fonts_pages">Pages</div>
                <div class="adv-v mono">{{ (it.pages ?? []).join(', ') || '—' }}</div>
              </div>
            }
          </div>
        </div>
      }
    }
  </div>

  <!-- ✅ Right options -->
  <div rightOptions>
    <div class="actions" style="flex-direction: column; align-items: flex-start;">
      <label class="muted" style="display:flex; gap:.5rem; align-items:center;">
        <input type="checkbox" [formControl]="form.controls.pretty" />
        <span i18n="@@pdf_fonts_pretty">JSON “pretty” (indenté)</span>
      </label>

      <label class="muted" style="display:flex; gap:.5rem; align-items:center;">
        <input type="checkbox" [formControl]="form.controls.includePages" />
        <span i18n="@@pdf_fonts_include_pages">Inclure les pages d’utilisation</span>
      </label>
    </div>
  </div>
</app-pdf-tool-shell>
